[
  {
    "objectID": "defibrillator_map.html",
    "href": "defibrillator_map.html",
    "title": "UK Defibrillator Locations",
    "section": "",
    "text": "This document maps the locations of Automated External Defibrillators (AEDs) across the UK. The data is sourced from The Circuit and contains over 116,000 defibrillator records.\nPoints are coloured by availability (blue = 24/7, orange = Varied) and shaded by access type (darker = Public, lighter = Restricted)."
  },
  {
    "objectID": "defibrillator_map.html#introduction",
    "href": "defibrillator_map.html#introduction",
    "title": "UK Defibrillator Locations",
    "section": "",
    "text": "This document maps the locations of Automated External Defibrillators (AEDs) across the UK. The data is sourced from The Circuit and contains over 116,000 defibrillator records.\nPoints are coloured by availability (blue = 24/7, orange = Varied) and shaded by access type (darker = Public, lighter = Restricted)."
  },
  {
    "objectID": "defibrillator_map.html#load-libraries-and-data",
    "href": "defibrillator_map.html#load-libraries-and-data",
    "title": "UK Defibrillator Locations",
    "section": "Load Libraries and Data",
    "text": "Load Libraries and Data\n\nlibrary(readxl)\nlibrary(sf)\nlibrary(dplyr)\nlibrary(leaflet)\nlibrary(htmltools)\n\ndefib &lt;- read_excel(\"defibrillator_data.xlsx\",\n                     sheet = \"data_extract_2026-02-02\")\n\nglimpse(defib)\n\nRows: 116,027\nColumns: 17\n$ unique_identifier           &lt;chr&gt; \"CD83C127-C680-40C2-AB36-ADEB00B751D3\", \"F…\n$ location_name               &lt;chr&gt; \"Aberdeen City Council\", \"Scottish Courts …\n$ address_line1               &lt;chr&gt; \"Agricola Street\", \"Aberdeen Civil Justice…\n$ address_line2               &lt;chr&gt; \"Milltimber\", \"Queen Street\", \"2 St Nichol…\n$ address_line3               &lt;chr&gt; \"NA\", \"NA\", \"NA\", \"NA\", NA, \"NA\", NA, \"NA\"…\n$ address_city                &lt;chr&gt; \"Aberdeen\", \"Aberdeen\", \"Aberdeen\", \"Aberd…\n$ address_county              &lt;chr&gt; \"NA\", \"Aberdeenshire\", \"Aberdeenshire\", \"A…\n$ address_post_code           &lt;chr&gt; \"AB1 0JH\", \"AB10 1AQ\", \"AB10 1BU\", \"AB10 1…\n$ country                     &lt;chr&gt; \"Scotland\", \"Scotland\", \"Scotland\", \"Scotl…\n$ ladnm                       &lt;chr&gt; \"Aberdeen City\", \"Aberdeen City\", \"Aberdee…\n$ lsoa21                      &lt;chr&gt; \"S01006515\", \"S01006586\", \"S01006646\", \"S0…\n$ lsoa21nm                    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ defibrillators_availability &lt;chr&gt; \"Varied Access\", \"Varied Access\", \"24/7 Ac…\n$ defibrillators_access_type  &lt;chr&gt; \"Public\", \"Public\", \"Public\", \"Public\", \"P…\n$ lat                         &lt;chr&gt; \"57.111269999999998\", \"57.1488941\", \"57.14…\n$ long                        &lt;dbl&gt; -2.230140, -2.095454, -2.097835, -2.107368…\n$ county                      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…"
  },
  {
    "objectID": "defibrillator_map.html#clean-and-convert-to-spatial-data",
    "href": "defibrillator_map.html#clean-and-convert-to-spatial-data",
    "title": "UK Defibrillator Locations",
    "section": "Clean and Convert to Spatial Data",
    "text": "Clean and Convert to Spatial Data\n\n# Remove rows with missing coordinates\ndefib_clean &lt;- defib %&gt;%\n  filter(!is.na(lat), !is.na(long))\n\n# Convert to sf object\ndefib_sf &lt;- st_as_sf(defib_clean, coords = c(\"long\", \"lat\"), crs = 4326)"
  },
  {
    "objectID": "defibrillator_map.html#assign-colours",
    "href": "defibrillator_map.html#assign-colours",
    "title": "UK Defibrillator Locations",
    "section": "Assign Colours",
    "text": "Assign Colours\n\n# Colour scheme:\n#   24/7 Access + Public     -&gt; dark blue   (#08519c)\n#   24/7 Access + Restricted -&gt; light blue  (#6baed6)\n#   Varied Access + Public   -&gt; dark orange (#d94701)\n#   Varied Access + Restricted -&gt; light orange (#fdae6b)\n\ndefib_sf &lt;- defib_sf %&gt;%\n  mutate(\n    point_colour = case_when(\n      defibrillators_availability == \"24/7 Access\" &\n        defibrillators_access_type == \"Public\"     ~ \"#08519c\",\n      defibrillators_availability == \"24/7 Access\" &\n        defibrillators_access_type == \"Restricted\" ~ \"#6baed6\",\n      defibrillators_availability == \"Varied Access\" &\n        defibrillators_access_type == \"Public\"     ~ \"#d94701\",\n      defibrillators_availability == \"Varied Access\" &\n        defibrillators_access_type == \"Restricted\" ~ \"#fdae6b\",\n      TRUE ~ \"#999999\"\n    )\n  )\n\n# Summary of colour categories\ndefib_sf %&gt;%\n  st_drop_geometry() %&gt;%\n  count(defibrillators_availability, defibrillators_access_type, point_colour,\n        name = \"count\") %&gt;%\n  arrange(desc(count))\n\n# A tibble: 4 × 4\n  defibrillators_availability defibrillators_access_type point_colour count\n  &lt;chr&gt;                       &lt;chr&gt;                      &lt;chr&gt;        &lt;int&gt;\n1 24/7 Access                 Public                     #08519c      62618\n2 Varied Access               Restricted                 #fdae6b      30046\n3 Varied Access               Public                     #d94701      17766\n4 24/7 Access                 Restricted                 #6baed6       5597"
  },
  {
    "objectID": "defibrillator_map.html#interactive-map",
    "href": "defibrillator_map.html#interactive-map",
    "title": "UK Defibrillator Locations",
    "section": "Interactive Map",
    "text": "Interactive Map\n\nleaflet(defib_sf) %&gt;%\n  addProviderTiles(providers$CartoDB.Positron) %&gt;%\n  addCircleMarkers(\n    radius = 3,\n    color = ~point_colour,\n    stroke = FALSE,\n    fillOpacity = 0.6,\n    popup = ~paste0(\n      \"&lt;strong&gt;\", location_name, \"&lt;/strong&gt;&lt;br&gt;\",\n      address_line1, \"&lt;br&gt;\",\n      address_city, \" \", address_post_code, \"&lt;br&gt;\",\n      \"&lt;em&gt;Availability:&lt;/em&gt; \", defibrillators_availability, \"&lt;br&gt;\",\n      \"&lt;em&gt;Access:&lt;/em&gt; \", defibrillators_access_type\n    )\n  ) %&gt;%\n  addLegend(\n    position = \"bottomright\",\n    colors = c(\"#08519c\", \"#6baed6\", \"#d94701\", \"#fdae6b\"),\n    labels = c(\"24/7 — Public\", \"24/7 — Restricted\",\n               \"Varied — Public\", \"Varied — Restricted\"),\n    title = \"Availability — Access\",\n    opacity = 0.8\n  )"
  },
  {
    "objectID": "brighton_analysis.html",
    "href": "brighton_analysis.html",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "",
    "text": "This analysis compares the current provision of 24/7 publicly accessible Automated External Defibrillators (AEDs) in Brighton & Hove against estimated daytime population demand. Using Census 2021 workday population density at Lower Super Output Area (LSOA) level as a proxy for where people are during the day, we identify areas with high demand but low defibrillator coverage — and rank them by priority for new AED placement.\nData sources:\n\nAED locations from The Circuit (February 2026 extract)\nCensus 2021 Workday Population Density (table WD001) from Nomis\nLSOA 2021 boundaries (BGC V5, Generalised Clipped) from the ONS Open Geography Portal\nTelephone box locations from OpenStreetMap via the Overpass API"
  },
  {
    "objectID": "brighton_analysis.html#introduction",
    "href": "brighton_analysis.html#introduction",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "",
    "text": "This analysis compares the current provision of 24/7 publicly accessible Automated External Defibrillators (AEDs) in Brighton & Hove against estimated daytime population demand. Using Census 2021 workday population density at Lower Super Output Area (LSOA) level as a proxy for where people are during the day, we identify areas with high demand but low defibrillator coverage — and rank them by priority for new AED placement.\nData sources:\n\nAED locations from The Circuit (February 2026 extract)\nCensus 2021 Workday Population Density (table WD001) from Nomis\nLSOA 2021 boundaries (BGC V5, Generalised Clipped) from the ONS Open Geography Portal\nTelephone box locations from OpenStreetMap via the Overpass API"
  },
  {
    "objectID": "brighton_analysis.html#load-libraries",
    "href": "brighton_analysis.html#load-libraries",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Load Libraries",
    "text": "Load Libraries\n\nlibrary(readxl)\nlibrary(sf)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(readr)\nlibrary(leaflet)\nlibrary(tmap)\nlibrary(classInt)\nlibrary(htmltools)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(jsonlite)"
  },
  {
    "objectID": "brighton_analysis.html#load-and-filter-defibrillator-data",
    "href": "brighton_analysis.html#load-and-filter-defibrillator-data",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Load and Filter Defibrillator Data",
    "text": "Load and Filter Defibrillator Data\n\n# Load full dataset\ndefib &lt;- read_excel(\"defibrillator_data.xlsx\",\n                     sheet = \"data_extract_2026-02-02\")\n\n# Filter to Brighton & Hove\nbh_defib &lt;- defib %&gt;%\n  filter(grepl(\"Brighton\", ladnm, ignore.case = TRUE),\n         !is.na(lat), !is.na(long))\n\ncat(\"Total AEDs in Brighton & Hove:\", nrow(bh_defib), \"\\n\")\n\nTotal AEDs in Brighton & Hove: 275 \n\n# Summary by availability and access type\nbh_defib %&gt;%\n  count(defibrillators_availability, defibrillators_access_type,\n        name = \"count\") %&gt;%\n  arrange(desc(count)) %&gt;%\n  kable(col.names = c(\"Availability\", \"Access Type\", \"Count\")) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n\n\n\n\nAvailability\nAccess Type\nCount\n\n\n\n\n24/7 Access\nPublic\n108\n\n\nVaried Access\nRestricted\n96\n\n\nVaried Access\nPublic\n62\n\n\n24/7 Access\nRestricted\n9\n\n\n\n\n\n\n# Filter to 24/7 public access defibrillators only\nbh_247_public &lt;- bh_defib %&gt;%\n  filter(defibrillators_availability == \"24/7 Access\",\n         defibrillators_access_type == \"Public\")\n\ncat(\"24/7 Public AEDs in Brighton & Hove:\", nrow(bh_247_public), \"\\n\")\n\n24/7 Public AEDs in Brighton & Hove: 108 \n\n# Convert to spatial\nbh_247_sf &lt;- st_as_sf(bh_247_public, coords = c(\"long\", \"lat\"), crs = 4326)\n\n# Also create sf for ALL B&H defibrillators (for context)\nbh_all_sf &lt;- st_as_sf(bh_defib, coords = c(\"long\", \"lat\"), crs = 4326)"
  },
  {
    "objectID": "brighton_analysis.html#download-external-data",
    "href": "brighton_analysis.html#download-external-data",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Download External Data",
    "text": "Download External Data\n\nLSOA 2021 Boundaries\n\n# Download Brighton & Hove LSOA boundaries from ONS ArcGIS FeatureServer\n# Using the BGC (Generalised Clipped) V5 version for higher-quality boundaries\napi_url &lt;- paste0(\n  \"https://services1.arcgis.com/ESMARspQHYMw9BZ9/arcgis/rest/services/\",\n  \"Lower_layer_Super_Output_Areas_December_2021_Boundaries_EW_BGC_V5/\",\n  \"FeatureServer/0/query?\",\n  \"where=LSOA21NM+LIKE+%27Brighton%25%27\",\n  \"&outFields=LSOA21CD,LSOA21NM\",\n  \"&returnGeometry=true\",\n  \"&outSR=4326\",\n  \"&f=geojson\",\n  \"&resultRecordCount=200\"\n)\n\n# Download to temp file and read\ntmp_geojson &lt;- tempfile(fileext = \".geojson\")\ndownload.file(api_url, tmp_geojson, quiet = TRUE, mode = \"wb\")\nbh_lsoa &lt;- st_read(tmp_geojson, quiet = TRUE)\n\ncat(\"LSOA boundaries loaded:\", nrow(bh_lsoa), \"LSOAs\\n\")\n\nLSOA boundaries loaded: 165 LSOAs\n\n\n\n\nCensus 2021 Workday Population Density (WD001)\n\n# Download WD001 from Nomis\ntmp_zip &lt;- tempfile(fileext = \".zip\")\ndownload.file(\"https://www.nomisweb.co.uk/output/census/2021/wd001.zip\",\n              tmp_zip, quiet = TRUE, mode = \"wb\")\n\n# Extract and read the LSOA-level CSV\ntmp_dir &lt;- tempdir()\nunzip(tmp_zip, exdir = tmp_dir)\n\nwd001 &lt;- read_csv(file.path(tmp_dir, \"WD001_lsoa.csv\"),\n                   show_col_types = FALSE)\n\n# Rename columns for easier use\nwd001 &lt;- wd001 %&gt;%\n  rename(\n    lsoa21cd = `Lower layer Super Output Areas Code`,\n    lsoa21nm = `Lower layer Super Output Areas Label`,\n    workday_density = `Population Density`\n  )\n\n# Filter to Brighton & Hove LSOAs\nbh_wd001 &lt;- wd001 %&gt;%\n  filter(lsoa21cd %in% bh_lsoa$LSOA21CD)\n\ncat(\"Workday density data for\", nrow(bh_wd001), \"Brighton & Hove LSOAs\\n\")\n\nWorkday density data for 165 Brighton & Hove LSOAs\n\ncat(\"Range:\", round(min(bh_wd001$workday_density)),\n    \"to\", round(max(bh_wd001$workday_density)),\n    \"persons per km²\\n\")\n\nRange: 267 to 52028 persons per km²\n\n\n\n\nOpenStreetMap Telephone Box Locations\nTelephone boxes are potential sites for new defibrillator installations — many across the UK have already been converted. We download current telephone box locations from OpenStreetMap via the Overpass API (amenity=telephone).\n\n# Query OSM Overpass API for telephone boxes in Brighton & Hove\n# Use a bounding box around Brighton & Hove to avoid URL encoding issues\n# with area names. B&H bbox: south=50.79, west=-0.30, north=50.89, east=-0.04\noverpass_query &lt;- '[out:json][timeout:30];node[amenity=telephone](50.79,-0.30,50.89,-0.04);out body;'\noverpass_url &lt;- paste0(\n  \"https://overpass-api.de/api/interpreter?data=\",\n  URLencode(overpass_query, reserved = TRUE)\n)\n\nosm_raw &lt;- fromJSON(overpass_url)\n\nphone_boxes &lt;- osm_raw$elements %&gt;%\n  select(id, lat, lon) %&gt;%\n  filter(!is.na(lat), !is.na(lon))\n\nphone_sf &lt;- st_as_sf(phone_boxes, coords = c(\"lon\", \"lat\"), crs = 4326)\n\ncat(\"Telephone boxes loaded from OSM:\", nrow(phone_sf), \"\\n\")\n\nTelephone boxes loaded from OSM: 56"
  },
  {
    "objectID": "brighton_analysis.html#build-analysis-dataset",
    "href": "brighton_analysis.html#build-analysis-dataset",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Build Analysis Dataset",
    "text": "Build Analysis Dataset\n\n# Count 24/7 public AEDs per LSOA\naed_counts &lt;- bh_247_public %&gt;%\n  count(lsoa21, name = \"aed_count\")\n\n# Join workday density to LSOA boundaries\nbh_analysis &lt;- bh_lsoa %&gt;%\n  left_join(bh_wd001, by = c(\"LSOA21CD\" = \"lsoa21cd\")) %&gt;%\n  left_join(aed_counts, by = c(\"LSOA21CD\" = \"lsoa21\")) %&gt;%\n  mutate(\n    aed_count = replace_na(aed_count, 0),\n    # Priority score: higher workday density with fewer AEDs = higher priority\n    priority_score = workday_density / (aed_count + 1),\n    priority_rank = rank(-priority_score, ties.method = \"first\")\n  )\n\ncat(\"LSOAs with zero 24/7 public AEDs:\",\n    sum(bh_analysis$aed_count == 0), \"of\", nrow(bh_analysis), \"\\n\")\n\nLSOAs with zero 24/7 public AEDs: 102 of 165"
  },
  {
    "objectID": "brighton_analysis.html#map-1-workday-population-demand-with-aed-locations",
    "href": "brighton_analysis.html#map-1-workday-population-demand-with-aed-locations",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Map 1: Workday Population Demand with AED Locations",
    "text": "Map 1: Workday Population Demand with AED Locations\nThis map shows the Census 2021 workday population density across Brighton & Hove LSOAs. Darker shading indicates higher concentrations of people during the working day. Red points show the locations of existing 24/7 publicly accessible defibrillators.\n\ntmap_mode(\"plot\")\n\ntm_shape(bh_analysis) +\n  tm_polygons(\n    fill = \"workday_density\",\n    fill.scale = tm_scale_continuous(\n      values = \"brewer.blues\"\n    ),\n    fill.legend = tm_legend(\n      title = \"Workday Pop.\\nDensity\\n(per km²)\"\n    ),\n    col = \"grey60\",\n    lwd = 0.5\n  ) +\n  tm_shape(bh_247_sf) +\n  tm_symbols(\n    fill = \"red\",\n    col = \"darkred\",\n    size = 0.3,\n    shape = 21\n  ) +\n  tm_title(\"Workday Population Demand & 24/7 Public AED Locations\") +\n  tm_layout(\n    frame = FALSE\n  ) +\n  tm_scalebar(position = c(\"left\", \"bottom\"))"
  },
  {
    "objectID": "brighton_analysis.html#map-2-interactive-demand-provision-map",
    "href": "brighton_analysis.html#map-2-interactive-demand-provision-map",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Map 2: Interactive Demand & Provision Map",
    "text": "Map 2: Interactive Demand & Provision Map\nZoom in to explore individual LSOAs and AED locations. Click on LSOAs for workday population data, or on red markers for AED details.\n\n# Create colour palette for workday density\npal_density &lt;- colorNumeric(\"Blues\", domain = bh_analysis$workday_density)\n\nleaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Positron) %&gt;%\n  # Choropleth layer\n  addPolygons(\n    data = bh_analysis,\n    fillColor = ~pal_density(workday_density),\n    fillOpacity = 0.6,\n    color = \"grey50\",\n    weight = 1,\n    popup = ~paste0(\n      \"&lt;strong&gt;\", LSOA21NM, \"&lt;/strong&gt;&lt;br&gt;\",\n      \"&lt;em&gt;Workday density:&lt;/em&gt; \",\n      format(round(workday_density), big.mark = \",\"), \" per km²&lt;br&gt;\",\n      \"&lt;em&gt;24/7 Public AEDs:&lt;/em&gt; \", aed_count, \"&lt;br&gt;\",\n      \"&lt;em&gt;Priority rank:&lt;/em&gt; \", priority_rank, \" of \", nrow(bh_analysis)\n    ),\n    group = \"Workday Density\"\n  ) %&gt;%\n  # AED point markers\n  addCircleMarkers(\n    data = bh_247_sf,\n    radius = 5,\n    color = \"darkred\",\n    fillColor = \"red\",\n    fillOpacity = 0.8,\n    weight = 1,\n    popup = ~paste0(\n      \"&lt;strong&gt;\", location_name, \"&lt;/strong&gt;&lt;br&gt;\",\n      address_line1, \"&lt;br&gt;\",\n      address_city, \" \", address_post_code\n    ),\n    group = \"24/7 Public AEDs\"\n  ) %&gt;%\n  addLegend(\n    position = \"bottomright\",\n    pal = pal_density,\n    values = bh_analysis$workday_density,\n    title = \"Workday Density&lt;br&gt;(per km²)\"\n  ) %&gt;%\n  addLayersControl(\n    overlayGroups = c(\"Workday Density\", \"24/7 Public AEDs\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )"
  },
  {
    "objectID": "brighton_analysis.html#map-3-coverage-gap-priority-areas-for-new-aeds",
    "href": "brighton_analysis.html#map-3-coverage-gap-priority-areas-for-new-aeds",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Map 3: Coverage Gap — Priority Areas for New AEDs",
    "text": "Map 3: Coverage Gap — Priority Areas for New AEDs\nThe priority score is calculated as: workday population density ÷ (number of existing 24/7 public AEDs + 1). A higher score indicates an LSOA with high daytime demand but few or no defibrillators — and therefore greater need for new provision.\nLSOAs outlined in red are the top 20 priority areas. Click on any LSOA for details.\n\n# Flag top 20 priority LSOAs\nbh_analysis &lt;- bh_analysis %&gt;%\n  mutate(top20 = priority_rank &lt;= 20)\n\n# Colour palette for priority score\npal_priority &lt;- colorNumeric(\"YlOrRd\", domain = bh_analysis$priority_score)\n\nleaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Positron) %&gt;%\n  # All LSOAs coloured by priority score\n  addPolygons(\n    data = bh_analysis,\n    fillColor = ~pal_priority(priority_score),\n    fillOpacity = 0.6,\n    color = ~ifelse(top20, \"red\", \"grey50\"),\n    weight = ~ifelse(top20, 3, 1),\n    popup = ~paste0(\n      \"&lt;strong&gt;\", LSOA21NM, \"&lt;/strong&gt;&lt;br&gt;\",\n      \"&lt;em&gt;Priority rank:&lt;/em&gt; &lt;strong&gt;\", priority_rank,\n      \"&lt;/strong&gt; of \", nrow(bh_analysis), \"&lt;br&gt;\",\n      \"&lt;em&gt;Priority score:&lt;/em&gt; \",\n      format(round(priority_score), big.mark = \",\"), \"&lt;br&gt;\",\n      \"&lt;em&gt;Workday density:&lt;/em&gt; \",\n      format(round(workday_density), big.mark = \",\"), \" per km²&lt;br&gt;\",\n      \"&lt;em&gt;24/7 Public AEDs:&lt;/em&gt; \", aed_count\n    ),\n    group = \"Priority Score\"\n  ) %&gt;%\n  # Existing AEDs\n  addCircleMarkers(\n    data = bh_247_sf,\n    radius = 4,\n    color = \"black\",\n    fillColor = \"white\",\n    fillOpacity = 0.9,\n    weight = 1.5,\n    popup = ~paste0(\n      \"&lt;strong&gt;\", location_name, \"&lt;/strong&gt;&lt;br&gt;\",\n      address_line1, \"&lt;br&gt;\",\n      address_city, \" \", address_post_code\n    ),\n    group = \"24/7 Public AEDs\"\n  ) %&gt;%\n  addLegend(\n    position = \"bottomright\",\n    pal = pal_priority,\n    values = bh_analysis$priority_score,\n    title = \"Priority Score\"\n  ) %&gt;%\n  addLayersControl(\n    overlayGroups = c(\"Priority Score\", \"24/7 Public AEDs\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )"
  },
  {
    "objectID": "brighton_analysis.html#priority-ranking-table",
    "href": "brighton_analysis.html#priority-ranking-table",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Priority Ranking Table",
    "text": "Priority Ranking Table\nThe table below ranks all Brighton & Hove LSOAs by priority for new 24/7 public defibrillator placement. LSOAs with high workday population density but few or no existing AEDs are ranked highest.\n\npriority_table &lt;- bh_analysis %&gt;%\n  st_drop_geometry() %&gt;%\n  select(\n    Rank = priority_rank,\n    LSOA = LSOA21NM,\n    `Workday Density (per km²)` = workday_density,\n    `24/7 Public AEDs` = aed_count,\n    `Priority Score` = priority_score\n  ) %&gt;%\n  arrange(Rank) %&gt;%\n  mutate(\n    `Workday Density (per km²)` = format(round(`Workday Density (per km²)`),\n                                          big.mark = \",\"),\n    `Priority Score` = format(round(`Priority Score`), big.mark = \",\")\n  )\n\n# Show top 20\npriority_table %&gt;%\n  head(20) %&gt;%\n  kable(align = c(\"r\", \"l\", \"r\", \"r\", \"r\")) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = FALSE) %&gt;%\n  row_spec(0, bold = TRUE)\n\n\n\n\nRank\nLSOA\nWorkday Density (per km²)\n24/7 Public AEDs\nPriority Score\n\n\n\n\n1\nBrighton and Hove 026B\n28,107\n0\n28,107\n\n\n2\nBrighton and Hove 031B\n52,028\n1\n26,014\n\n\n3\nBrighton and Hove 029C\n23,370\n0\n23,370\n\n\n4\nBrighton and Hove 030B\n21,688\n0\n21,688\n\n\n5\nBrighton and Hove 027F\n21,522\n0\n21,522\n\n\n6\nBrighton and Hove 029E\n20,784\n0\n20,784\n\n\n7\nBrighton and Hove 015D\n19,733\n0\n19,733\n\n\n8\nBrighton and Hove 029B\n19,366\n0\n19,366\n\n\n9\nBrighton and Hove 026E\n18,232\n0\n18,232\n\n\n10\nBrighton and Hove 024D\n17,287\n0\n17,287\n\n\n11\nBrighton and Hove 022E\n17,129\n0\n17,129\n\n\n12\nBrighton and Hove 022C\n16,954\n0\n16,954\n\n\n13\nBrighton and Hove 026D\n16,704\n0\n16,704\n\n\n14\nBrighton and Hove 024E\n16,196\n0\n16,196\n\n\n15\nBrighton and Hove 016C\n16,043\n0\n16,043\n\n\n16\nBrighton and Hove 019C\n15,691\n0\n15,691\n\n\n17\nBrighton and Hove 024B\n15,646\n0\n15,646\n\n\n18\nBrighton and Hove 026C\n15,557\n0\n15,557\n\n\n19\nBrighton and Hove 022A\n15,520\n0\n15,520\n\n\n20\nBrighton and Hove 027A\n15,200\n0\n15,200\n\n\n\n\n\n\nFull Ranking — Interactive Map\nThis map shows all LSOAs coloured by priority rank (darker red = higher priority), with existing 24/7 public AED locations (red markers) and OpenStreetMap telephone box locations (green markers). Telephone boxes represent potential sites for new defibrillator installations.\n\n# Colour palette: rank 1 = darkest, rank 165 = lightest\npal_rank &lt;- colorNumeric(\n  palette = \"YlOrRd\",\n  domain = bh_analysis$priority_rank,\n  reverse = TRUE\n)\n\nleaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Positron) %&gt;%\n  # LSOAs coloured by priority rank\n  addPolygons(\n    data = bh_analysis,\n    fillColor = ~pal_rank(priority_rank),\n    fillOpacity = 0.5,\n    color = \"grey50\",\n    weight = 1,\n    popup = ~paste0(\n      \"&lt;strong&gt;\", LSOA21NM, \"&lt;/strong&gt;&lt;br&gt;\",\n      \"&lt;em&gt;Priority rank:&lt;/em&gt; &lt;strong&gt;\", priority_rank,\n      \"&lt;/strong&gt; of \", nrow(bh_analysis), \"&lt;br&gt;\",\n      \"&lt;em&gt;Priority score:&lt;/em&gt; \",\n      format(round(priority_score), big.mark = \",\"), \"&lt;br&gt;\",\n      \"&lt;em&gt;Workday density:&lt;/em&gt; \",\n      format(round(workday_density), big.mark = \",\"), \" per km²&lt;br&gt;\",\n      \"&lt;em&gt;24/7 Public AEDs:&lt;/em&gt; \", aed_count\n    ),\n    group = \"Priority Ranking\"\n  ) %&gt;%\n  # Existing 24/7 public AEDs\n  addCircleMarkers(\n    data = bh_247_sf,\n    radius = 5,\n    color = \"darkred\",\n    fillColor = \"red\",\n    fillOpacity = 0.8,\n    weight = 1,\n    popup = ~paste0(\n      \"&lt;strong&gt;\", location_name, \"&lt;/strong&gt;&lt;br&gt;\",\n      address_line1, \"&lt;br&gt;\",\n      address_city, \" \", address_post_code\n    ),\n    group = \"24/7 Public AEDs\"\n  ) %&gt;%\n  # OSM telephone boxes\n  addCircleMarkers(\n    data = phone_sf,\n    radius = 5,\n    color = \"darkgreen\",\n    fillColor = \"#2ca02c\",\n    fillOpacity = 0.8,\n    weight = 1,\n    popup = ~paste0(\n      \"&lt;strong&gt;Telephone Box&lt;/strong&gt;&lt;br&gt;\",\n      \"&lt;em&gt;OSM ID:&lt;/em&gt; \", id\n    ),\n    group = \"Telephone Boxes (OSM)\"\n  ) %&gt;%\n  addLegend(\n    position = \"bottomright\",\n    pal = pal_rank,\n    values = bh_analysis$priority_rank,\n    title = \"Priority Rank\",\n    labFormat = labelFormat(transform = function(x) round(x))\n  ) %&gt;%\n  addLegend(\n    position = \"bottomright\",\n    colors = c(\"red\", \"#2ca02c\"),\n    labels = c(\"24/7 Public AED\", \"Telephone Box\"),\n    title = \"Points\"\n  ) %&gt;%\n  addLayersControl(\n    overlayGroups = c(\"Priority Ranking\", \"24/7 Public AEDs\",\n                      \"Telephone Boxes (OSM)\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )\n\n\n\n\n\n\n\nFull Ranking Table\n\npriority_table %&gt;%\n  kable(align = c(\"r\", \"l\", \"r\", \"r\", \"r\")) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = FALSE) %&gt;%\n  row_spec(0, bold = TRUE) %&gt;%\n  scroll_box(height = \"400px\")\n\n\n\n\n\nRank\nLSOA\nWorkday Density (per km²)\n24/7 Public AEDs\nPriority Score\n\n\n\n\n1\nBrighton and Hove 026B\n28,107\n0\n28,107\n\n\n2\nBrighton and Hove 031B\n52,028\n1\n26,014\n\n\n3\nBrighton and Hove 029C\n23,370\n0\n23,370\n\n\n4\nBrighton and Hove 030B\n21,688\n0\n21,688\n\n\n5\nBrighton and Hove 027F\n21,522\n0\n21,522\n\n\n6\nBrighton and Hove 029E\n20,784\n0\n20,784\n\n\n7\nBrighton and Hove 015D\n19,733\n0\n19,733\n\n\n8\nBrighton and Hove 029B\n19,366\n0\n19,366\n\n\n9\nBrighton and Hove 026E\n18,232\n0\n18,232\n\n\n10\nBrighton and Hove 024D\n17,287\n0\n17,287\n\n\n11\nBrighton and Hove 022E\n17,129\n0\n17,129\n\n\n12\nBrighton and Hove 022C\n16,954\n0\n16,954\n\n\n13\nBrighton and Hove 026D\n16,704\n0\n16,704\n\n\n14\nBrighton and Hove 024E\n16,196\n0\n16,196\n\n\n15\nBrighton and Hove 016C\n16,043\n0\n16,043\n\n\n16\nBrighton and Hove 019C\n15,691\n0\n15,691\n\n\n17\nBrighton and Hove 024B\n15,646\n0\n15,646\n\n\n18\nBrighton and Hove 026C\n15,557\n0\n15,557\n\n\n19\nBrighton and Hove 022A\n15,520\n0\n15,520\n\n\n20\nBrighton and Hove 027A\n15,200\n0\n15,200\n\n\n21\nBrighton and Hove 027B\n15,183\n0\n15,183\n\n\n22\nBrighton and Hove 024C\n15,032\n0\n15,032\n\n\n23\nBrighton and Hove 027C\n14,996\n0\n14,996\n\n\n24\nBrighton and Hove 018B\n13,752\n0\n13,752\n\n\n25\nBrighton and Hove 028B\n13,467\n0\n13,467\n\n\n26\nBrighton and Hove 022B\n13,416\n0\n13,416\n\n\n27\nBrighton and Hove 019A\n13,363\n0\n13,363\n\n\n28\nBrighton and Hove 016D\n12,978\n0\n12,978\n\n\n29\nBrighton and Hove 019B\n12,927\n0\n12,927\n\n\n30\nBrighton and Hove 016B\n12,898\n0\n12,898\n\n\n31\nBrighton and Hove 020E\n12,502\n0\n12,502\n\n\n32\nBrighton and Hove 020C\n11,591\n0\n11,591\n\n\n33\nBrighton and Hove 010B\n11,049\n0\n11,049\n\n\n34\nBrighton and Hove 021D\n11,034\n0\n11,034\n\n\n35\nBrighton and Hove 010E\n10,942\n0\n10,942\n\n\n36\nBrighton and Hove 028A\n10,626\n0\n10,626\n\n\n37\nBrighton and Hove 031D\n10,567\n0\n10,567\n\n\n38\nBrighton and Hove 030A\n20,648\n1\n10,324\n\n\n39\nBrighton and Hove 030C\n20,473\n1\n10,237\n\n\n40\nBrighton and Hove 018E\n10,117\n0\n10,117\n\n\n41\nBrighton and Hove 023A\n9,958\n0\n9,958\n\n\n42\nBrighton and Hove 029D\n19,912\n1\n9,956\n\n\n43\nBrighton and Hove 018D\n9,598\n0\n9,598\n\n\n44\nBrighton and Hove 028E\n9,527\n0\n9,527\n\n\n45\nBrighton and Hove 023C\n9,512\n0\n9,512\n\n\n46\nBrighton and Hove 025B\n9,292\n0\n9,292\n\n\n47\nBrighton and Hove 014A\n9,206\n0\n9,206\n\n\n48\nBrighton and Hove 010A\n9,106\n0\n9,106\n\n\n49\nBrighton and Hove 029A\n9,030\n0\n9,030\n\n\n50\nBrighton and Hove 014B\n8,927\n0\n8,927\n\n\n51\nBrighton and Hove 032B\n8,582\n0\n8,582\n\n\n52\nBrighton and Hove 022D\n17,117\n1\n8,559\n\n\n53\nBrighton and Hove 010C\n8,522\n0\n8,522\n\n\n54\nBrighton and Hove 020D\n8,514\n0\n8,514\n\n\n55\nBrighton and Hove 019E\n8,210\n0\n8,210\n\n\n56\nBrighton and Hove 020A\n8,184\n0\n8,184\n\n\n57\nBrighton and Hove 025E\n8,174\n0\n8,174\n\n\n58\nBrighton and Hove 031E\n8,008\n0\n8,008\n\n\n59\nBrighton and Hove 013B\n7,977\n0\n7,977\n\n\n60\nBrighton and Hove 026A\n15,546\n1\n7,773\n\n\n61\nBrighton and Hove 031C\n15,477\n1\n7,739\n\n\n62\nBrighton and Hove 015E\n15,470\n1\n7,735\n\n\n63\nBrighton and Hove 027G\n15,204\n1\n7,602\n\n\n64\nBrighton and Hove 011C\n7,358\n0\n7,358\n\n\n65\nBrighton and Hove 025C\n7,122\n0\n7,122\n\n\n66\nBrighton and Hove 025F\n6,862\n0\n6,862\n\n\n67\nBrighton and Hove 015A\n13,723\n1\n6,862\n\n\n68\nBrighton and Hove 008D\n6,853\n0\n6,853\n\n\n69\nBrighton and Hove 014E\n13,278\n1\n6,639\n\n\n70\nBrighton and Hove 008C\n6,362\n0\n6,362\n\n\n71\nBrighton and Hove 004D\n6,176\n0\n6,176\n\n\n72\nBrighton and Hove 009C\n6,080\n0\n6,080\n\n\n73\nBrighton and Hove 012B\n5,960\n0\n5,960\n\n\n74\nBrighton and Hove 012C\n5,648\n0\n5,648\n\n\n75\nBrighton and Hove 015C\n11,254\n1\n5,627\n\n\n76\nBrighton and Hove 015B\n11,049\n1\n5,524\n\n\n77\nBrighton and Hove 013A\n5,453\n0\n5,453\n\n\n78\nBrighton and Hove 030D\n10,838\n1\n5,419\n\n\n79\nBrighton and Hove 006E\n5,412\n0\n5,412\n\n\n80\nBrighton and Hove 020B\n10,752\n1\n5,376\n\n\n81\nBrighton and Hove 007E\n5,364\n0\n5,364\n\n\n82\nBrighton and Hove 032D\n5,349\n0\n5,349\n\n\n83\nBrighton and Hove 012A\n5,107\n0\n5,107\n\n\n84\nBrighton and Hove 011D\n10,112\n1\n5,056\n\n\n85\nBrighton and Hove 012D\n5,025\n0\n5,025\n\n\n86\nBrighton and Hove 010D\n10,000\n1\n5,000\n\n\n87\nBrighton and Hove 024A\n14,737\n2\n4,912\n\n\n88\nBrighton and Hove 001D\n4,740\n0\n4,740\n\n\n89\nBrighton and Hove 006A\n4,720\n0\n4,720\n\n\n90\nBrighton and Hove 005E\n4,686\n0\n4,686\n\n\n91\nBrighton and Hove 008E\n4,656\n0\n4,656\n\n\n92\nBrighton and Hove 004A\n4,623\n0\n4,623\n\n\n93\nBrighton and Hove 007B\n4,608\n0\n4,608\n\n\n94\nBrighton and Hove 001C\n4,369\n0\n4,369\n\n\n95\nBrighton and Hove 013C\n4,295\n0\n4,295\n\n\n96\nBrighton and Hove 018C\n12,764\n2\n4,255\n\n\n97\nBrighton and Hove 023B\n8,301\n1\n4,151\n\n\n98\nBrighton and Hove 019D\n12,244\n2\n4,081\n\n\n99\nBrighton and Hove 011E\n8,161\n1\n4,080\n\n\n100\nBrighton and Hove 018A\n4,047\n0\n4,047\n\n\n101\nBrighton and Hove 027E\n16,133\n3\n4,033\n\n\n102\nBrighton and Hove 008B\n3,932\n0\n3,932\n\n\n103\nBrighton and Hove 017C\n3,803\n0\n3,803\n\n\n104\nBrighton and Hove 013F\n3,782\n0\n3,782\n\n\n105\nBrighton and Hove 028C\n7,481\n1\n3,740\n\n\n106\nBrighton and Hove 005B\n3,679\n0\n3,679\n\n\n107\nBrighton and Hove 004B\n3,340\n0\n3,340\n\n\n108\nBrighton and Hove 001A\n3,224\n0\n3,224\n\n\n109\nBrighton and Hove 009D\n3,224\n0\n3,224\n\n\n110\nBrighton and Hove 006C\n6,435\n1\n3,217\n\n\n111\nBrighton and Hove 021E\n6,319\n1\n3,160\n\n\n112\nBrighton and Hove 033B\n3,155\n0\n3,155\n\n\n113\nBrighton and Hove 017D\n3,102\n0\n3,102\n\n\n114\nBrighton and Hove 028D\n6,163\n1\n3,082\n\n\n115\nBrighton and Hove 005D\n3,068\n0\n3,068\n\n\n116\nBrighton and Hove 021B\n6,119\n1\n3,060\n\n\n117\nBrighton and Hove 025D\n2,920\n0\n2,920\n\n\n118\nBrighton and Hove 011B\n2,834\n0\n2,834\n\n\n119\nBrighton and Hove 032A\n8,496\n2\n2,832\n\n\n120\nBrighton and Hove 021A\n5,510\n1\n2,755\n\n\n121\nBrighton and Hove 012E\n5,510\n1\n2,755\n\n\n122\nBrighton and Hove 002D\n5,380\n1\n2,690\n\n\n123\nBrighton and Hove 007D\n2,591\n0\n2,591\n\n\n124\nBrighton and Hove 014D\n7,453\n2\n2,484\n\n\n125\nBrighton and Hove 023D\n4,959\n1\n2,479\n\n\n126\nBrighton and Hove 007C\n2,325\n0\n2,325\n\n\n127\nBrighton and Hove 030E\n11,068\n4\n2,214\n\n\n128\nBrighton and Hove 016A\n5,993\n2\n1,998\n\n\n129\nBrighton and Hove 013D\n3,993\n1\n1,997\n\n\n130\nBrighton and Hove 013E\n5,857\n2\n1,952\n\n\n131\nBrighton and Hove 031A\n5,751\n2\n1,917\n\n\n132\nBrighton and Hove 009B\n5,405\n2\n1,802\n\n\n133\nBrighton and Hove 003E\n3,532\n1\n1,766\n\n\n134\nBrighton and Hove 005C\n4,969\n2\n1,656\n\n\n135\nBrighton and Hove 001B\n3,187\n1\n1,594\n\n\n136\nBrighton and Hove 033C\n1,497\n0\n1,497\n\n\n137\nBrighton and Hove 004C\n2,815\n1\n1,407\n\n\n138\nBrighton and Hove 009E\n1,292\n0\n1,292\n\n\n139\nBrighton and Hove 017A\n3,819\n2\n1,273\n\n\n140\nBrighton and Hove 014C\n3,726\n2\n1,242\n\n\n141\nBrighton and Hove 009A\n1,212\n0\n1,212\n\n\n142\nBrighton and Hove 003A\n3,586\n2\n1,195\n\n\n143\nBrighton and Hove 003C\n2,327\n1\n1,164\n\n\n144\nBrighton and Hove 021C\n4,052\n3\n1,013\n\n\n145\nBrighton and Hove 033E\n3,007\n2\n1,002\n\n\n146\nBrighton and Hove 001E\n978\n0\n978\n\n\n147\nBrighton and Hove 007A\n2,864\n2\n955\n\n\n148\nBrighton and Hove 006B\n1,859\n1\n930\n\n\n149\nBrighton and Hove 002A\n3,532\n3\n883\n\n\n150\nBrighton and Hove 017B\n844\n0\n844\n\n\n151\nBrighton and Hove 011A\n3,010\n3\n752\n\n\n152\nBrighton and Hove 017F\n752\n0\n752\n\n\n153\nBrighton and Hove 033A\n714\n0\n714\n\n\n154\nBrighton and Hove 002C\n1,265\n1\n632\n\n\n155\nBrighton and Hove 008A\n765\n1\n382\n\n\n156\nBrighton and Hove 017E\n339\n0\n339\n\n\n157\nBrighton and Hove 006D\n304\n0\n304\n\n\n158\nBrighton and Hove 033D\n1,196\n3\n299\n\n\n159\nBrighton and Hove 032C\n1,736\n5\n289\n\n\n160\nBrighton and Hove 003D\n267\n0\n267\n\n\n161\nBrighton and Hove 002B\n1,462\n5\n244\n\n\n162\nBrighton and Hove 033F\n539\n3\n135\n\n\n163\nBrighton and Hove 025A\n560\n4\n112\n\n\n164\nBrighton and Hove 005A\n273\n2\n91\n\n\n165\nBrighton and Hove 003B\n434\n4\n87"
  },
  {
    "objectID": "brighton_analysis.html#summary",
    "href": "brighton_analysis.html#summary",
    "title": "Brighton & Hove: Defibrillator Provision vs. Daytime Demand",
    "section": "Summary",
    "text": "Summary\nKey findings:\n\nBrighton & Hove has 165 LSOAs and 108 24/7 publicly accessible AEDs\n102 LSOAs (62%) have no 24/7 public AED\nThe highest-priority LSOA for new provision is Brighton and Hove 026B with a workday population density of 28,107 persons per km² and 0 existing 24/7 public AED(s)\nThe priority ranking combines both demand (workday population density) and existing supply, meaning LSOAs that already have good coverage are ranked lower regardless of their density\n\n\nData sourced from The Circuit and ONS Census 2021. Is this an emergency? This website is used to locate defibrillators, but it is not intended for use in an emergency. If you require urgent medical assistance, call 999 now."
  },
  {
    "objectID": "brighton_mclp.html",
    "href": "brighton_mclp.html",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "",
    "text": "This analysis extends the priority-ranking approach by applying a Maximal Coverage Location Problem (MCLP) optimisation to identify the best locations for new Automated External Defibrillators (AEDs) in Brighton & Hove.\nRather than simply ranking LSOAs by need, the MCLP directly answers the question: given a budget for p new AEDs, where should they be placed to maximise the population covered within a given walking distance?\nKey features of this approach:\n\nNetwork-based walking distances (not straight-line) via OpenStreetMap street data\nCandidate locations drawn from real-world sites (pharmacies, schools, community centres, libraries, sports centres, GP surgeries, supermarkets, telephone boxes)\nMathematical optimisation using Mixed Integer Programming to guarantee the best solution\nScenario testing across multiple coverage radii and numbers of new AEDs\n\nData sources:\n\nAED locations from The Circuit (February 2026 extract)\nCensus 2021 Workday Population Density (table WD001) from Nomis\nLSOA 2021 boundaries (BGC V5, Generalised Clipped) from the ONS Open Geography Portal\nCandidate locations and street network from OpenStreetMap"
  },
  {
    "objectID": "brighton_mclp.html#introduction",
    "href": "brighton_mclp.html#introduction",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "",
    "text": "This analysis extends the priority-ranking approach by applying a Maximal Coverage Location Problem (MCLP) optimisation to identify the best locations for new Automated External Defibrillators (AEDs) in Brighton & Hove.\nRather than simply ranking LSOAs by need, the MCLP directly answers the question: given a budget for p new AEDs, where should they be placed to maximise the population covered within a given walking distance?\nKey features of this approach:\n\nNetwork-based walking distances (not straight-line) via OpenStreetMap street data\nCandidate locations drawn from real-world sites (pharmacies, schools, community centres, libraries, sports centres, GP surgeries, supermarkets, telephone boxes)\nMathematical optimisation using Mixed Integer Programming to guarantee the best solution\nScenario testing across multiple coverage radii and numbers of new AEDs\n\nData sources:\n\nAED locations from The Circuit (February 2026 extract)\nCensus 2021 Workday Population Density (table WD001) from Nomis\nLSOA 2021 boundaries (BGC V5, Generalised Clipped) from the ONS Open Geography Portal\nCandidate locations and street network from OpenStreetMap"
  },
  {
    "objectID": "brighton_mclp.html#load-libraries",
    "href": "brighton_mclp.html#load-libraries",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Load Libraries",
    "text": "Load Libraries\n\nlibrary(readxl)\nlibrary(sf)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(readr)\nlibrary(leaflet)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(htmltools)\nlibrary(osmdata)\nlibrary(dodgr)\nlibrary(ompr)\nlibrary(ompr.roi)\nlibrary(ROI)\nlibrary(ROI.plugin.glpk)"
  },
  {
    "objectID": "brighton_mclp.html#load-and-filter-defibrillator-data",
    "href": "brighton_mclp.html#load-and-filter-defibrillator-data",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Load and Filter Defibrillator Data",
    "text": "Load and Filter Defibrillator Data\n\n# Load full dataset\ndefib &lt;- read_excel(\"defibrillator_data.xlsx\",\n                     sheet = \"data_extract_2026-02-02\")\n\n# Filter to Brighton & Hove — 24/7 public access only\nbh_defib &lt;- defib %&gt;%\n  filter(grepl(\"Brighton\", ladnm, ignore.case = TRUE),\n         !is.na(lat), !is.na(long))\n\nbh_247_public &lt;- bh_defib %&gt;%\n  filter(defibrillators_availability == \"24/7 Access\",\n         defibrillators_access_type == \"Public\")\n\nbh_247_sf &lt;- st_as_sf(bh_247_public, coords = c(\"long\", \"lat\"), crs = 4326)\n\ncat(\"24/7 Public AEDs in Brighton & Hove:\", nrow(bh_247_sf), \"\\n\")\n\n24/7 Public AEDs in Brighton & Hove: 108"
  },
  {
    "objectID": "brighton_mclp.html#download-lsoa-boundaries-and-workday-population",
    "href": "brighton_mclp.html#download-lsoa-boundaries-and-workday-population",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Download LSOA Boundaries and Workday Population",
    "text": "Download LSOA Boundaries and Workday Population\n\n# Download Brighton & Hove LSOA boundaries from ONS ArcGIS FeatureServer\napi_url &lt;- paste0(\n  \"https://services1.arcgis.com/ESMARspQHYMw9BZ9/arcgis/rest/services/\",\n  \"Lower_layer_Super_Output_Areas_December_2021_Boundaries_EW_BGC_V5/\",\n  \"FeatureServer/0/query?\",\n  \"where=LSOA21NM+LIKE+%27Brighton%25%27\",\n  \"&outFields=LSOA21CD,LSOA21NM\",\n  \"&returnGeometry=true\",\n  \"&outSR=4326\",\n  \"&f=geojson\",\n  \"&resultRecordCount=200\"\n)\n\ntmp_geojson &lt;- tempfile(fileext = \".geojson\")\ndownload.file(api_url, tmp_geojson, quiet = TRUE, mode = \"wb\")\nbh_lsoa &lt;- st_read(tmp_geojson, quiet = TRUE)\n\ncat(\"LSOA boundaries loaded:\", nrow(bh_lsoa), \"LSOAs\\n\")\n\nLSOA boundaries loaded: 165 LSOAs\n\n\n\n# Download WD001 workday population density from Nomis\ntmp_zip &lt;- tempfile(fileext = \".zip\")\ndownload.file(\"https://www.nomisweb.co.uk/output/census/2021/wd001.zip\",\n              tmp_zip, quiet = TRUE, mode = \"wb\")\n\ntmp_dir &lt;- tempdir()\nunzip(tmp_zip, exdir = tmp_dir)\n\nwd001 &lt;- read_csv(file.path(tmp_dir, \"WD001_lsoa.csv\"),\n                   show_col_types = FALSE)\n\nwd001 &lt;- wd001 %&gt;%\n  rename(\n    lsoa21cd = `Lower layer Super Output Areas Code`,\n    lsoa21nm = `Lower layer Super Output Areas Label`,\n    workday_density = `Population Density`\n  )\n\nbh_wd001 &lt;- wd001 %&gt;%\n  filter(lsoa21cd %in% bh_lsoa$LSOA21CD)\n\ncat(\"Workday density data for\", nrow(bh_wd001), \"Brighton & Hove LSOAs\\n\")\n\nWorkday density data for 165 Brighton & Hove LSOAs"
  },
  {
    "objectID": "brighton_mclp.html#build-demand-points",
    "href": "brighton_mclp.html#build-demand-points",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Build Demand Points",
    "text": "Build Demand Points\nWe use population-weighted LSOA centroids as demand points. Each centroid carries the workday population density as its weight — LSOAs where more people are present during the working day exert higher demand for AED coverage.\n\n# Join workday density to LSOA boundaries\nbh_analysis &lt;- bh_lsoa %&gt;%\n  left_join(bh_wd001, by = c(\"LSOA21CD\" = \"lsoa21cd\")) %&gt;%\n  mutate(workday_density = replace_na(workday_density, 0))\n\n# Create population-weighted centroids as demand points\ndemand_pts &lt;- st_centroid(bh_analysis)\n\n# Extract coordinates for distance computation\ndemand_coords &lt;- st_coordinates(demand_pts)\ndemand_pts$lon &lt;- demand_coords[, 1]\ndemand_pts$lat &lt;- demand_coords[, 2]\n\ncat(\"Demand points (LSOA centroids):\", nrow(demand_pts), \"\\n\")\n\nDemand points (LSOA centroids): 165 \n\ncat(\"Total workday density weight:\",\n    format(round(sum(demand_pts$workday_density)), big.mark = \",\"), \"\\n\")\n\nTotal workday density weight: 1,429,176"
  },
  {
    "objectID": "brighton_mclp.html#extract-candidate-locations-from-openstreetmap",
    "href": "brighton_mclp.html#extract-candidate-locations-from-openstreetmap",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Extract Candidate Locations from OpenStreetMap",
    "text": "Extract Candidate Locations from OpenStreetMap\nWe query OpenStreetMap for potential AED installation sites — community-facing locations that are typically accessible to the public and have existing infrastructure (power, shelter). Candidates within 50m of an existing AED are excluded.\n\n# Define Brighton & Hove bounding box for osmdata\nbh_bb &lt;- matrix(c(-0.30, 50.79, -0.04, 50.89), nrow = 2,\n                dimnames = list(c(\"x\", \"y\"), c(\"min\", \"max\")))\n\n# POI types to query: list of key-value pairs\npoi_types &lt;- list(\n  pharmacy = c(\"amenity\", \"pharmacy\"),\n  school = c(\"amenity\", \"school\"),\n  community_centre = c(\"amenity\", \"community_centre\"),\n  library = c(\"amenity\", \"library\"),\n  sports_centre = c(\"leisure\", \"sports_centre\"),\n  doctors = c(\"amenity\", \"doctors\"),\n  supermarket = c(\"shop\", \"supermarket\"),\n  telephone = c(\"amenity\", \"telephone\")\n)\n\n# Query each POI type via osmdata\nall_candidates &lt;- list()\n\nfor (poi_name in names(poi_types)) {\n  tag_key &lt;- poi_types[[poi_name]][1]\n  tag_val &lt;- poi_types[[poi_name]][2]\n\n  result &lt;- tryCatch({\n    osm_result &lt;- opq(bbox = bh_bb, timeout = 60) %&gt;%\n      add_osm_feature(key = tag_key, value = tag_val) %&gt;%\n      osmdata_sf()\n\n    # Collect point features from nodes\n    pts &lt;- NULL\n    if (!is.null(osm_result$osm_points) && nrow(osm_result$osm_points) &gt; 0) {\n      coords &lt;- st_coordinates(osm_result$osm_points)\n      pts &lt;- data.frame(\n        id = osm_result$osm_points$osm_id,\n        lon = coords[, 1],\n        lat = coords[, 2]\n      )\n    }\n\n    # Collect centroids from polygon/way features\n    polys &lt;- NULL\n    if (!is.null(osm_result$osm_polygons) && nrow(osm_result$osm_polygons) &gt; 0) {\n      centroids &lt;- st_centroid(osm_result$osm_polygons)\n      coords &lt;- st_coordinates(centroids)\n      polys &lt;- data.frame(\n        id = osm_result$osm_polygons$osm_id,\n        lon = coords[, 1],\n        lat = coords[, 2]\n      )\n    }\n\n    combined &lt;- bind_rows(pts, polys)\n    if (!is.null(combined) && nrow(combined) &gt; 0) {\n      combined %&gt;% mutate(poi_type = poi_name)\n    } else {\n      NULL\n    }\n  }, error = function(e) {\n    cat(sprintf(\"  Warning: failed to fetch %s: %s\\n\", poi_name, e$message))\n    NULL\n  })\n\n  if (!is.null(result) && nrow(result) &gt; 0) {\n    all_candidates[[poi_name]] &lt;- result\n  }\n\n  cat(sprintf(\"  %s: %d features\\n\", poi_name,\n              if (!is.null(result)) nrow(result) else 0L))\n\n  # Brief pause to be polite to Overpass API\n  Sys.sleep(1)\n}\n\n  pharmacy: 112 features\n\n\n  school: 2313 features\n\n\n  community_centre: 420 features\n\n\n  library: 222 features\n\n\n  sports_centre: 361 features\n\n\n  doctors: 162 features\n\n\n  supermarket: 540 features\n  telephone: 56 features\n\ncandidates_df &lt;- bind_rows(all_candidates)\ncandidates_sf &lt;- st_as_sf(candidates_df, coords = c(\"lon\", \"lat\"), crs = 4326)\n\ncat(\"Total candidate locations from OSM:\", nrow(candidates_sf), \"\\n\")\n\nTotal candidate locations from OSM: 4186 \n\ncat(\"By type:\\n\")\n\nBy type:\n\nprint(table(candidates_sf$poi_type))\n\n\ncommunity_centre          doctors          library         pharmacy \n             420              162              222              112 \n          school    sports_centre      supermarket        telephone \n            2313              361              540               56 \n\n\n\n# Remove candidates within 50m of an existing 24/7 public AED\n# Transform to BNG for distance calculation in metres\ncandidates_bng &lt;- st_transform(candidates_sf, 27700)\naed_bng &lt;- st_transform(bh_247_sf, 27700)\n\n# Calculate distance from each candidate to nearest existing AED\nnearest_dist &lt;- st_distance(candidates_bng, aed_bng)\nmin_dist &lt;- apply(nearest_dist, 1, min)\n\n# Keep candidates &gt;50m from any existing AED\ncandidates_sf &lt;- candidates_sf[as.numeric(min_dist) &gt; 50, ]\ncandidates_bng &lt;- candidates_bng[as.numeric(min_dist) &gt; 50, ]\n\ncat(\"Candidates after removing those within 50m of existing AEDs:\",\n    nrow(candidates_sf), \"\\n\")\n\nCandidates after removing those within 50m of existing AEDs: 3914 \n\ncat(\"By type:\\n\")\n\nBy type:\n\nprint(table(candidates_sf$poi_type))\n\n\ncommunity_centre          doctors          library         pharmacy \n             358              101              202              111 \n          school    sports_centre      supermarket        telephone \n            2261              335              494               52"
  },
  {
    "objectID": "brighton_mclp.html#network-distance-calculation",
    "href": "brighton_mclp.html#network-distance-calculation",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Network Distance Calculation",
    "text": "Network Distance Calculation\nWe compute walking distances along the OpenStreetMap street network using the dodgr package. This gives realistic travel times rather than straight-line (Euclidean) distances, which underestimate actual walking distance by a factor of typically 1.3–1.5 in urban areas.\nDistance matrices are cached as .rds files since computation is expensive.\n\n# File paths for cached results\ncache_graph &lt;- \"brighton_dodgr_graph.rds\"\ncache_dist_candidates &lt;- \"brighton_distance_matrix.rds\"\ncache_dist_existing &lt;- \"brighton_existing_dist.rds\"\n\nif (file.exists(cache_dist_candidates) && file.exists(cache_dist_existing)) {\n  cat(\"Loading cached distance matrices...\\n\")\n  dist_to_candidates &lt;- readRDS(cache_dist_candidates)\n  dist_to_existing &lt;- readRDS(cache_dist_existing)\n} else {\n  cat(\"Computing network distances (this may take a few minutes)...\\n\")\n\n  # Download OSM street network for walking\n  if (file.exists(cache_graph)) {\n    graph &lt;- readRDS(cache_graph)\n  } else {\n    # Use osmdata to download the street network with a longer timeout\n    # dodgr_streetnet() uses a short Overpass timeout that fails for larger areas\n    bh_bb &lt;- matrix(c(-0.30, 50.79, -0.04, 50.89), nrow = 2,\n                    dimnames = list(c(\"x\", \"y\"), c(\"min\", \"max\")))\n    cat(\"Downloading OSM street network via osmdata...\\n\")\n    bh_streets &lt;- opq(bbox = bh_bb, timeout = 120) %&gt;%\n      add_osm_feature(key = \"highway\") %&gt;%\n      osmdata_sf()\n\n    # Extract the lines (road/path geometries) for dodgr\n    bh_lines &lt;- bh_streets$osm_lines\n    graph &lt;- weight_streetnet(bh_lines, wt_profile = \"foot\")\n    saveRDS(graph, cache_graph)\n  }\n\n  # Prepare coordinate matrices\n  demand_xy &lt;- data.frame(\n    x = demand_pts$lon,\n    y = demand_pts$lat\n  )\n\n  candidate_coords &lt;- st_coordinates(candidates_sf)\n  candidate_xy &lt;- data.frame(\n    x = candidate_coords[, 1],\n    y = candidate_coords[, 2]\n  )\n\n  existing_coords &lt;- st_coordinates(bh_247_sf)\n  existing_xy &lt;- data.frame(\n    x = existing_coords[, 1],\n    y = existing_coords[, 2]\n  )\n\n  # Compute distance matrix: demand points -&gt; candidate locations\n  cat(\"Computing distances: demand points -&gt; candidates...\\n\")\n  dist_to_candidates &lt;- dodgr_dists(\n    graph,\n    from = demand_xy,\n    to = candidate_xy,\n    quiet = FALSE\n  )\n\n  # Compute distance matrix: demand points -&gt; existing AEDs\n  cat(\"Computing distances: demand points -&gt; existing AEDs...\\n\")\n  dist_to_existing &lt;- dodgr_dists(\n    graph,\n    from = demand_xy,\n    to = existing_xy,\n    quiet = FALSE\n  )\n\n  # Cache results\n  saveRDS(dist_to_candidates, cache_dist_candidates)\n  saveRDS(dist_to_existing, cache_dist_existing)\n  cat(\"Distance matrices cached.\\n\")\n}\n\nLoading cached distance matrices...\n\ncat(\"Distance matrix (demand -&gt; candidates):\",\n    nrow(dist_to_candidates), \"x\", ncol(dist_to_candidates), \"\\n\")\n\nDistance matrix (demand -&gt; candidates): 165 x 3702 \n\ncat(\"Distance matrix (demand -&gt; existing):\",\n    nrow(dist_to_existing), \"x\", ncol(dist_to_existing), \"\\n\")\n\nDistance matrix (demand -&gt; existing): 165 x 108"
  },
  {
    "objectID": "brighton_mclp.html#current-coverage-baseline",
    "href": "brighton_mclp.html#current-coverage-baseline",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Current Coverage Baseline",
    "text": "Current Coverage Baseline\nBefore optimising, we establish how well the existing AED network covers the population at different distance thresholds.\n\n# For each demand point, find the minimum walking distance to any existing AED\nmin_dist_existing &lt;- apply(dist_to_existing, 1, function(row) {\n  d &lt;- row[!is.na(row)]\n  if (length(d) == 0) Inf else min(d)\n})\n\n# Calculate baseline coverage at different radii\nradii &lt;- c(100, 200, 300)\nbaseline_coverage &lt;- sapply(radii, function(r) {\n  covered &lt;- min_dist_existing &lt;= r\n  # Weighted coverage: proportion of total workday density that is covered\n  sum(demand_pts$workday_density[covered]) /\n    sum(demand_pts$workday_density) * 100\n})\n\nbaseline_df &lt;- data.frame(\n  `Coverage Radius (m)` = radii,\n  `LSOAs Covered` = sapply(radii, function(r) sum(min_dist_existing &lt;= r)),\n  `Total LSOAs` = nrow(demand_pts),\n  `Population-Weighted Coverage (%)` = round(baseline_coverage, 1),\n  check.names = FALSE\n)\n\nkable(baseline_df, align = \"rrrr\") %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE) %&gt;%\n  row_spec(0, bold = TRUE)\n\n\n\n\nCoverage Radius (m)\nLSOAs Covered\nTotal LSOAs\nPopulation-Weighted Coverage (%)\n\n\n\n\n100\n6\n165\n4.5\n\n\n200\n10\n165\n7.9\n\n\n300\n27\n165\n23.1"
  },
  {
    "objectID": "brighton_mclp.html#mclp-formulation",
    "href": "brighton_mclp.html#mclp-formulation",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "MCLP Formulation",
    "text": "MCLP Formulation\nThe Maximal Coverage Location Problem is formulated as a Mixed Integer Program:\nSets:\n\n\\(I\\) = demand points (LSOA centroids), indexed by \\(i\\)\n\\(J\\) = candidate locations, indexed by \\(j\\)\n\nParameters:\n\n\\(w_i\\) = workday population density weight for demand point \\(i\\)\n\\(d_{ij}\\) = network walking distance from demand point \\(i\\) to candidate \\(j\\)\n\\(R\\) = coverage radius threshold (metres)\n\\(p\\) = number of new AEDs to place\n\\(N_i\\) = set of candidates within radius \\(R\\) of demand \\(i\\): \\(N_i = \\{j : d_{ij} \\leq R\\}\\)\n\nDecision Variables:\n\n\\(y_j \\in \\{0, 1\\}\\) — 1 if a new AED is placed at candidate \\(j\\)\n\\(z_i \\in \\{0, 1\\}\\) — 1 if demand point \\(i\\) is newly covered\n\nObjective: Maximise total weighted coverage\n\\[\\max \\sum_{i \\in I} w_i \\cdot z_i\\]\nSubject to:\n\\[z_i \\leq \\sum_{j \\in N_i} y_j \\quad \\forall i \\in I\\] \\[\\sum_{j \\in J} y_j = p\\] \\[y_j \\in \\{0, 1\\}, \\quad z_i \\in \\{0, 1\\}\\]\nDemand points already covered by existing AEDs have their weights set to zero so the optimiser focuses on extending coverage to currently uncovered areas.\n\nsolve_mclp &lt;- function(dist_to_candidates, dist_to_existing,\n                       weights, radius, p) {\n  n_demand &lt;- nrow(dist_to_candidates)\n  n_candidates &lt;- ncol(dist_to_candidates)\n\n  # Determine which demand points are already covered by existing AEDs\n  min_existing &lt;- apply(dist_to_existing, 1, function(row) {\n    d &lt;- row[!is.na(row)]\n    if (length(d) == 0) Inf else min(d)\n  })\n  already_covered &lt;- min_existing &lt;= radius\n\n  # Set weight to 0 for already-covered demand points\n  w &lt;- weights\n  w[already_covered] &lt;- 0\n\n  # Build coverage matrix: which candidates can cover which demand points\n  # a[i,j] = 1 if candidate j is within radius of demand point i\n  coverage &lt;- (!is.na(dist_to_candidates)) & (dist_to_candidates &lt;= radius)\n  # Convert logical to numeric for the solver\n  coverage_num &lt;- matrix(as.numeric(coverage), nrow = n_demand, ncol = n_candidates)\n\n  # Build and solve MCLP using ompr\n  # Use MILPModel which supports external data indexing in constraints\n  model &lt;- MILPModel() %&gt;%\n    # y[j] = 1 if we place AED at candidate j\n    add_variable(y[j], j = 1:n_candidates, type = \"binary\") %&gt;%\n    # z[i] = 1 if demand point i is newly covered\n    add_variable(z[i], i = 1:n_demand, type = \"binary\") %&gt;%\n    # Maximise weighted coverage\n    set_objective(sum_over(w[i] * z[i], i = 1:n_demand), \"max\") %&gt;%\n    # z[i] can only be 1 if at least one covering candidate is selected\n    add_constraint(\n      z[i] &lt;= sum_over(coverage_num[i, j] * y[j], j = 1:n_candidates),\n      i = 1:n_demand\n    ) %&gt;%\n    # Place exactly p new AEDs\n    add_constraint(sum_over(y[j], j = 1:n_candidates) == p)\n\n  # Solve\n  result &lt;- solve_model(model, with_ROI(solver = \"glpk\", verbose = FALSE))\n\n  # Extract results\n  selected &lt;- result %&gt;%\n    get_solution(y[j]) %&gt;%\n    filter(value &gt; 0.5)\n\n  newly_covered &lt;- result %&gt;%\n    get_solution(z[i]) %&gt;%\n    filter(value &gt; 0.5)\n\n  # Calculate coverage statistics\n  total_weight &lt;- sum(weights)\n  existing_coverage &lt;- sum(weights[already_covered])\n  new_coverage &lt;- sum(w[newly_covered$i])\n  total_coverage &lt;- existing_coverage + new_coverage\n\n  list(\n    selected_indices = selected$j,\n    n_already_covered = sum(already_covered),\n    n_newly_covered = nrow(newly_covered),\n    pct_existing = existing_coverage / total_weight * 100,\n    pct_new = new_coverage / total_weight * 100,\n    pct_total = total_coverage / total_weight * 100,\n    objective = objective_value(result),\n    status = solver_status(result)\n  )\n}"
  },
  {
    "objectID": "brighton_mclp.html#run-optimisation-scenarios",
    "href": "brighton_mclp.html#run-optimisation-scenarios",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Run Optimisation Scenarios",
    "text": "Run Optimisation Scenarios\nWe test 3 coverage radii (100m, 200m, 300m) crossed with 4 placement counts (5, 10, 15, 20 new AEDs) for a total of 12 scenarios.\n\nradii &lt;- c(100, 200, 300)\np_values &lt;- c(5, 10, 15, 20)\n\nresults_list &lt;- list()\n\nfor (radius in radii) {\n  for (p in p_values) {\n    cat(sprintf(\"Solving: radius = %dm, p = %d new AEDs... \", radius, p))\n    res &lt;- solve_mclp(\n      dist_to_candidates, dist_to_existing,\n      demand_pts$workday_density, radius, p\n    )\n    cat(sprintf(\"Status: %s | Coverage: %.1f%% -&gt; %.1f%%\\n\",\n                res$status, res$pct_existing, res$pct_total))\n\n    results_list[[paste(radius, p, sep = \"_\")]] &lt;- data.frame(\n      radius = radius,\n      new_aeds = p,\n      existing_coverage_pct = round(res$pct_existing, 1),\n      new_coverage_pct = round(res$pct_new, 1),\n      total_coverage_pct = round(res$pct_total, 1),\n      lsoas_already_covered = res$n_already_covered,\n      lsoas_newly_covered = res$n_newly_covered,\n      status = res$status\n    )\n  }\n}\n\nSolving: radius = 100m, p = 5 new AEDs... Status: success | Coverage: 4.5% -&gt; 4.5%\nSolving: radius = 100m, p = 10 new AEDs... Status: success | Coverage: 4.5% -&gt; 4.5%\nSolving: radius = 100m, p = 15 new AEDs... Status: success | Coverage: 4.5% -&gt; 4.5%\nSolving: radius = 100m, p = 20 new AEDs... Status: success | Coverage: 4.5% -&gt; 4.5%\nSolving: radius = 200m, p = 5 new AEDs... Status: success | Coverage: 7.9% -&gt; 7.9%\nSolving: radius = 200m, p = 10 new AEDs... Status: success | Coverage: 7.9% -&gt; 7.9%\nSolving: radius = 200m, p = 15 new AEDs... Status: success | Coverage: 7.9% -&gt; 7.9%\nSolving: radius = 200m, p = 20 new AEDs... Status: success | Coverage: 7.9% -&gt; 7.9%\nSolving: radius = 300m, p = 5 new AEDs... Status: success | Coverage: 23.1% -&gt; 24.1%\nSolving: radius = 300m, p = 10 new AEDs... Status: success | Coverage: 23.1% -&gt; 24.1%\nSolving: radius = 300m, p = 15 new AEDs... Status: success | Coverage: 23.1% -&gt; 24.1%\nSolving: radius = 300m, p = 20 new AEDs... Status: success | Coverage: 23.1% -&gt; 24.1%\n\nscenarios &lt;- bind_rows(results_list)"
  },
  {
    "objectID": "brighton_mclp.html#sensitivity-analysis",
    "href": "brighton_mclp.html#sensitivity-analysis",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Sensitivity Analysis",
    "text": "Sensitivity Analysis\n\n# Format as a readable table\nsensitivity &lt;- scenarios %&gt;%\n  mutate(\n    improvement = total_coverage_pct - existing_coverage_pct,\n    label = sprintf(\"%.1f%% (+%.1f pp)\", total_coverage_pct, improvement)\n  ) %&gt;%\n  select(radius, new_aeds, label) %&gt;%\n  pivot_wider(names_from = new_aeds, values_from = label,\n              names_prefix = \"p = \")\n\nkable(\n  sensitivity,\n  col.names = c(\"Coverage Radius (m)\", paste(p_values, \"new AEDs\")),\n  align = \"rcccc\",\n  caption = \"Population-weighted coverage (% of total workday density) after adding optimally-placed AEDs\"\n) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE) %&gt;%\n  row_spec(0, bold = TRUE) %&gt;%\n  column_spec(1, bold = TRUE)\n\n\nPopulation-weighted coverage (% of total workday density) after adding optimally-placed AEDs\n\n\nCoverage Radius (m)\n5 new AEDs\n10 new AEDs\n15 new AEDs\n20 new AEDs\n\n\n\n\n100\n4.5% (+0.0 pp)\n4.5% (+0.0 pp)\n4.5% (+0.0 pp)\n4.5% (+0.0 pp)\n\n\n200\n7.9% (+0.0 pp)\n7.9% (+0.0 pp)\n7.9% (+0.0 pp)\n7.9% (+0.0 pp)\n\n\n300\n24.1% (+1.0 pp)\n24.1% (+1.0 pp)\n24.1% (+1.0 pp)\n24.1% (+1.0 pp)\n\n\n\n\n\n\n# Bar chart of coverage improvement\nlibrary(ggplot2)\n\nscenarios %&gt;%\n  mutate(\n    radius_label = paste0(radius, \"m radius\"),\n    improvement = total_coverage_pct - existing_coverage_pct\n  ) %&gt;%\n  ggplot(aes(x = factor(new_aeds), y = total_coverage_pct, fill = radius_label)) +\n  geom_col(position = \"dodge\", width = 0.7) +\n  geom_hline(\n    data = scenarios %&gt;%\n      distinct(radius, existing_coverage_pct) %&gt;%\n      mutate(radius_label = paste0(radius, \"m radius\")),\n    aes(yintercept = existing_coverage_pct, colour = radius_label),\n    linetype = \"dashed\", linewidth = 0.6\n  ) +\n  scale_fill_brewer(palette = \"Set2\", name = \"Scenario\") +\n  scale_colour_brewer(palette = \"Set2\", name = \"Baseline\") +\n  labs(\n    title = \"Population-Weighted Coverage by Scenario\",\n    subtitle = \"Dashed lines show current baseline coverage (before adding new AEDs)\",\n    x = \"Number of New AEDs\",\n    y = \"Coverage (%)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "brighton_mclp.html#best-scenario-map-200m-radius-10-new-aeds",
    "href": "brighton_mclp.html#best-scenario-map-200m-radius-10-new-aeds",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Best Scenario Map: 200m Radius, 10 New AEDs",
    "text": "Best Scenario Map: 200m Radius, 10 New AEDs\nWe focus on the 200m radius / 10 new AEDs scenario as a practical middle-ground for detailed mapping.\n\n# Re-run the 200m / 10 scenario to get the selected locations\nbest &lt;- solve_mclp(\n  dist_to_candidates, dist_to_existing,\n  demand_pts$workday_density, radius = 200, p = 10\n)\n\n# Get the selected candidate locations\noptimal_sf &lt;- candidates_sf[best$selected_indices, ]\n\ncat(\"Optimal new AED locations (200m radius, 10 new AEDs):\\n\")\n\nOptimal new AED locations (200m radius, 10 new AEDs):\n\ncat(sprintf(\"  Coverage improvement: %.1f%% -&gt; %.1f%% (+%.1f pp)\\n\",\n            best$pct_existing, best$pct_total,\n            best$pct_total - best$pct_existing))\n\n  Coverage improvement: 7.9% -&gt; 7.9% (+0.0 pp)\n\n\n\n# Colour palette for workday density\npal_density &lt;- colorNumeric(\"Blues\", domain = bh_analysis$workday_density)\n\nleaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Positron) %&gt;%\n  # LSOA boundaries coloured by workday density\n  addPolygons(\n    data = bh_analysis,\n    fillColor = ~pal_density(workday_density),\n    fillOpacity = 0.5,\n    color = \"grey50\",\n    weight = 1,\n    popup = ~paste0(\n      \"&lt;strong&gt;\", LSOA21NM, \"&lt;/strong&gt;&lt;br&gt;\",\n      \"&lt;em&gt;Workday density:&lt;/em&gt; \",\n      format(round(workday_density), big.mark = \",\"), \" per km²\"\n    ),\n    group = \"Workday Density\"\n  ) %&gt;%\n  # Existing AEDs\n  addCircleMarkers(\n    data = bh_247_sf,\n    radius = 5,\n    color = \"darkred\",\n    fillColor = \"red\",\n    fillOpacity = 0.7,\n    weight = 1,\n    popup = ~paste0(\n      \"&lt;strong&gt;\", location_name, \"&lt;/strong&gt;&lt;br&gt;\",\n      address_line1, \"&lt;br&gt;\",\n      address_city, \" \", address_post_code\n    ),\n    group = \"Existing 24/7 Public AEDs\"\n  ) %&gt;%\n  # Optimal new locations\n  addCircleMarkers(\n    data = optimal_sf,\n    radius = 8,\n    color = \"darkgreen\",\n    fillColor = \"#2ca02c\",\n    fillOpacity = 0.9,\n    weight = 2,\n    popup = ~paste0(\n      \"&lt;strong&gt;Optimal New AED Site&lt;/strong&gt;&lt;br&gt;\",\n      \"&lt;em&gt;Type:&lt;/em&gt; \", poi_type, \"&lt;br&gt;\",\n      \"&lt;em&gt;OSM ID:&lt;/em&gt; \", id\n    ),\n    group = \"Optimal New Locations\"\n  ) %&gt;%\n  addLegend(\n    position = \"bottomright\",\n    pal = pal_density,\n    values = bh_analysis$workday_density,\n    title = \"Workday Density&lt;br&gt;(per km²)\"\n  ) %&gt;%\n  addLegend(\n    position = \"bottomright\",\n    colors = c(\"red\", \"#2ca02c\"),\n    labels = c(\"Existing AED\", \"Optimal New Site\"),\n    title = \"AED Locations\"\n  ) %&gt;%\n  addLayersControl(\n    overlayGroups = c(\"Workday Density\", \"Existing 24/7 Public AEDs\",\n                      \"Optimal New Locations\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )"
  },
  {
    "objectID": "brighton_mclp.html#coverage-comparison-map",
    "href": "brighton_mclp.html#coverage-comparison-map",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Coverage Comparison Map",
    "text": "Coverage Comparison Map\nThis map shows 200m coverage zones before and after the optimised placement. Blue zones show current coverage from existing AEDs; green zones show additional coverage from the 10 optimally-placed new AEDs.\n\n# Transform to BNG for buffering in metres\nexisting_bng &lt;- st_transform(bh_247_sf, 27700)\noptimal_bng &lt;- st_transform(optimal_sf, 27700)\n\n# Create 200m buffers\nexisting_buffer &lt;- st_union(st_buffer(existing_bng, 200))\noptimal_buffer &lt;- st_union(st_buffer(optimal_bng, 200))\n\n# New coverage = optimal buffer minus existing buffer\nnew_coverage_zone &lt;- st_difference(optimal_buffer, existing_buffer)\n\n# Transform back to WGS84 for leaflet\nexisting_buffer_wgs &lt;- st_transform(existing_buffer, 4326)\nnew_coverage_wgs &lt;- st_transform(new_coverage_zone, 4326)\n\nleaflet() %&gt;%\n  addProviderTiles(providers$CartoDB.Positron) %&gt;%\n  # LSOA boundaries\n  addPolygons(\n    data = bh_analysis,\n    fillOpacity = 0,\n    color = \"grey70\",\n    weight = 0.5,\n    group = \"LSOA Boundaries\"\n  ) %&gt;%\n  # Existing coverage (blue)\n  addPolygons(\n    data = existing_buffer_wgs,\n    fillColor = \"#3182bd\",\n    fillOpacity = 0.3,\n    color = \"#3182bd\",\n    weight = 1,\n    group = \"Current Coverage (200m)\"\n  ) %&gt;%\n  # New additional coverage (green)\n  addPolygons(\n    data = new_coverage_wgs,\n    fillColor = \"#2ca02c\",\n    fillOpacity = 0.3,\n    color = \"#2ca02c\",\n    weight = 1,\n    group = \"New Additional Coverage (200m)\"\n  ) %&gt;%\n  # Existing AEDs\n  addCircleMarkers(\n    data = bh_247_sf,\n    radius = 4,\n    color = \"#3182bd\",\n    fillColor = \"#3182bd\",\n    fillOpacity = 0.8,\n    weight = 1,\n    group = \"Existing AEDs\"\n  ) %&gt;%\n  # Optimal new locations\n  addCircleMarkers(\n    data = optimal_sf,\n    radius = 6,\n    color = \"darkgreen\",\n    fillColor = \"#2ca02c\",\n    fillOpacity = 0.9,\n    weight = 2,\n    group = \"New AED Locations\"\n  ) %&gt;%\n  addLegend(\n    position = \"bottomright\",\n    colors = c(\"#3182bd\", \"#2ca02c\"),\n    labels = c(\"Current 200m Coverage\", \"New Additional Coverage\"),\n    title = \"Coverage Zones\"\n  ) %&gt;%\n  addLayersControl(\n    overlayGroups = c(\"LSOA Boundaries\", \"Current Coverage (200m)\",\n                      \"New Additional Coverage (200m)\",\n                      \"Existing AEDs\", \"New AED Locations\"),\n    options = layersControlOptions(collapsed = FALSE)\n  )"
  },
  {
    "objectID": "brighton_mclp.html#network-vs-euclidean-distance-comparison",
    "href": "brighton_mclp.html#network-vs-euclidean-distance-comparison",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Network vs Euclidean Distance Comparison",
    "text": "Network vs Euclidean Distance Comparison\nNetwork (walking) distances are typically 1.3–1.5× longer than straight-line distances in urban areas, due to the layout of streets, one-way systems, and pedestrian barriers. Using Euclidean distances would overestimate AED accessibility.\n\n# For each demand point, compute Euclidean distance to nearest existing AED\ndemand_bng &lt;- st_transform(demand_pts, 27700)\neuclidean_dist &lt;- st_distance(demand_bng, aed_bng)\nmin_euclidean &lt;- apply(euclidean_dist, 1, min)\n\n# Compare with network distances\ncomparison_df &lt;- data.frame(\n  lsoa = demand_pts$LSOA21NM,\n  euclidean_m = as.numeric(min_euclidean),\n  network_m = min_dist_existing\n) %&gt;%\n  filter(is.finite(network_m)) %&gt;%\n  mutate(\n    ratio = network_m / euclidean_m,\n    difference_m = network_m - euclidean_m\n  )\n\ncat(\"Network vs Euclidean distance to nearest existing AED:\\n\")\n\nNetwork vs Euclidean distance to nearest existing AED:\n\ncat(sprintf(\"  Mean ratio: %.2f (network is %.0f%% longer)\\n\",\n            mean(comparison_df$ratio, na.rm = TRUE),\n            (mean(comparison_df$ratio, na.rm = TRUE) - 1) * 100))\n\n  Mean ratio: 2.09 (network is 109% longer)\n\ncat(sprintf(\"  Median ratio: %.2f\\n\",\n            median(comparison_df$ratio, na.rm = TRUE)))\n\n  Median ratio: 1.59\n\ncat(sprintf(\"  Mean additional walking distance: %.0fm\\n\",\n            mean(comparison_df$difference_m, na.rm = TRUE)))\n\n  Mean additional walking distance: 266m\n\n\n\nggplot(comparison_df, aes(x = euclidean_m, y = network_m)) +\n  geom_point(alpha = 0.5, colour = \"#3182bd\") +\n  geom_abline(slope = 1, intercept = 0, linetype = \"dashed\", colour = \"grey40\") +\n  geom_smooth(method = \"lm\", se = FALSE, colour = \"#e6550d\", linewidth = 0.8) +\n  labs(\n    title = \"Network vs Euclidean Distance to Nearest AED\",\n    subtitle = \"Points above the dashed line indicate network distance exceeds Euclidean\",\n    x = \"Euclidean (straight-line) Distance (m)\",\n    y = \"Network (walking) Distance (m)\"\n  ) +\n  coord_equal() +\n  theme_minimal()"
  },
  {
    "objectID": "brighton_mclp.html#optimal-location-details",
    "href": "brighton_mclp.html#optimal-location-details",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Optimal Location Details",
    "text": "Optimal Location Details\n\n# Get coordinates of optimal locations\noptimal_coords &lt;- st_coordinates(optimal_sf)\n\noptimal_table &lt;- data.frame(\n  Site = 1:nrow(optimal_sf),\n  Type = optimal_sf$poi_type,\n  Longitude = round(optimal_coords[, 1], 5),\n  Latitude = round(optimal_coords[, 2], 5),\n  `OSM ID` = optimal_sf$id,\n  check.names = FALSE\n)\n\nkable(\n  optimal_table,\n  caption = \"Optimal locations for 10 new AEDs (200m coverage radius)\",\n  align = \"rlrrr\"\n) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE) %&gt;%\n  row_spec(0, bold = TRUE)\n\n\nOptimal locations for 10 new AEDs (200m coverage radius)\n\n\nSite\nType\nLongitude\nLatitude\nOSM ID\n\n\n\n\n1\npharmacy\n-0.14036\n50.83757\n419371218\n\n\n2\npharmacy\n-0.14718\n50.83051\n482261802\n\n\n3\npharmacy\n-0.12576\n50.83155\n665995930\n\n\n4\npharmacy\n-0.12980\n50.83227\n665995935\n\n\n5\npharmacy\n-0.14368\n50.84401\n1130206872\n\n\n6\npharmacy\n-0.13403\n50.82088\n1511429258\n\n\n7\npharmacy\n-0.13413\n50.82090\n1511429261\n\n\n8\npharmacy\n-0.13410\n50.82097\n1511429271\n\n\n9\npharmacy\n-0.13396\n50.82103\n1511429302\n\n\n10\npharmacy\n-0.13406\n50.82105\n1511429317"
  },
  {
    "objectID": "brighton_mclp.html#summary",
    "href": "brighton_mclp.html#summary",
    "title": "Brighton & Hove: Optimal AED Placement Using MCLP Optimisation",
    "section": "Summary",
    "text": "Summary\nKey findings:\n\nBrighton & Hove has 108 existing 24/7 publicly accessible AEDs and 3914 candidate sites were identified from OpenStreetMap\nAt 200m network walking distance, current AEDs cover 7.9% of the workday population\nAdding 10 optimally-placed AEDs increases 200m coverage to 7.9% — an improvement of 0 percentage points\nNetwork walking distances are typically 30–50% longer than straight-line distances, making Euclidean-based analyses overstate true accessibility\nThe MCLP optimisation guarantees the mathematically best placement given the coverage radius and number of new AEDs\n\nScenario comparison:\nThe sensitivity analysis shows diminishing returns as more AEDs are added — the first 5 provide the largest coverage gain per unit. Wider radii (300m) naturally achieve higher coverage but may exceed comfortable walking distance in an emergency. The 200m radius represents a practical balance.\n\nData sourced from The Circuit, ONS Census 2021, and OpenStreetMap. Is this an emergency? This website is used to locate defibrillators, but it is not intended for use in an emergency. If you require urgent medical assistance, call 999 now."
  }
]